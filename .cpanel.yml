---
deployment:
  tasks:
    # ğŸ“ Set your public root folder (where the site is visible)
    - export DEPLOYPATH=/home/boxgra6/titus-duc.calisearch.org

    - /bin/echo "ğŸš€ Starting Homelytics static deployment..."

    # 1ï¸âƒ£ Frontend: build + export static site
    - cd /home/boxgra6/titus-duc.calisearch.org/app/frontend
    - /bin/echo "ğŸ“¦ Installing dependencies..."
    - /bin/npm install
    - /bin/echo "ğŸ—ï¸ Building and exporting static site..."
    - /bin/npm run build
    - /bin/npm run export

    # 2ï¸âƒ£ Clear previous files (optional but cleaner)
    - /bin/echo "ğŸ§¹ Cleaning old files from deployment path..."
    - /bin/find $DEPLOYPATH -mindepth 1 -maxdepth 1 ! -name '.well-known' ! -name 'cgi-bin' -exec rm -rf {} \;

    # 3ï¸âƒ£ Copy new static build to live site root
    - /bin/echo "ğŸšš Copying new build to $DEPLOYPATH..."
    - /bin/cp -R out/* $DEPLOYPATH/

    - /bin/echo "âœ… Homelytics static deployment completed successfully!"
