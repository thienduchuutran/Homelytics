---
deployment:
  tasks:
    - export DEPLOYPATH=/home/boxgra6/titus-duc.calisearch.org

    - /bin/echo "ğŸš€ Starting Homelytics static export deployment..."

    # 1ï¸âƒ£ Build the static site
    - cd /home/boxgra6/titus-duc.calisearch.org/app/frontend
    - /bin/echo "ğŸ“¦ Installing dependencies..."
    - /bin/npm install
    - /bin/echo "ğŸ—ï¸ Building static export..."
    - /bin/npm run build

    # 2ï¸âƒ£ Clean old files from root (optional but tidy)
    - /bin/echo "ğŸ§¹ Cleaning old files..."
    - /bin/find $DEPLOYPATH -mindepth 1 -maxdepth 1 ! -name '.well-known' ! -name 'cgi-bin' -exec rm -rf {} \;

    # 3ï¸âƒ£ Copy build output to live root
    - /bin/echo "ğŸšš Copying new build to $DEPLOYPATH..."
    - /bin/cp -R out/* $DEPLOYPATH/

    - /bin/echo "âœ… Homelytics static export deployed successfully!"
